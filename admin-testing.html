<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Testing Portal - $NUTS Sports Pick'em</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="src/assets/images/nuts-logo.jpg">
    
    <!-- Styles -->
    <link rel="stylesheet" href="src/css/styles.css">
    
    <style>
        .testing-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            background: #0a0a0a;
            min-height: 100vh;
        }
        
        .testing-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #ff6b00, #ff9900);
            border-radius: 12px;
            color: white;
        }
        
        .testing-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .testing-tab {
            padding: 12px 24px;
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .testing-tab.active {
            background: #ff6b00;
            border-color: #ff6b00;
            color: white;
        }
        
        .testing-tab:hover {
            border-color: #ff6b00;
        }
        
        .testing-section {
            display: none;
            background: #1a1a1a;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .testing-section.active {
            display: block;
        }
        
        .section-title {
            color: #ff6b00;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-panel {
            background: #252525;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #333;
        }
        
        .control-title {
            color: #ffa500;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .btn-testing {
            background: #ff6b00;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-testing:hover {
            background: #ff9900;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .status-display {
            background: #0d1421;
            border: 1px solid #2d3748;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            color: #e2e8f0;
        }
        
        .mock-games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .mock-game-card {
            background: #252525;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #333;
        }
        
        .game-matchup {
            font-weight: bold;
            color: #fff;
            margin-bottom: 8px;
        }
        
        .game-time {
            color: #888;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .game-controls {
            display: flex;
            gap: 8px;
        }
        
        .game-controls button {
            flex: 1;
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .entries-table {
            background: #252525;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .entries-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .entries-table th,
        .entries-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        
        .entries-table th {
            background: #333;
            color: #ffa500;
            font-weight: bold;
        }
        
        .entries-table td {
            color: #ccc;
        }
        
        .prize-badge {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .input-group {
            margin: 15px 0;
        }
        
        .input-group label {
            display: block;
            color: #ccc;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: #fff;
        }
        
        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #ff6b00;
        }
        
        .wallet-info {
            background: #2d5a2d;
            border: 1px solid #4a7c4a;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .wallet-info h4 {
            color: #90ee90;
            margin: 0 0 10px 0;
        }
        
        .wallet-info p {
            color: #ccc;
            margin: 5px 0;
            font-family: monospace;
            font-size: 14px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid;
        }
        
        .alert-info {
            background: #1e3a8a;
            border-color: #3b82f6;
            color: #dbeafe;
        }
        
        .alert-warning {
            background: #92400e;
            border-color: #f59e0b;
            color: #fef3c7;
        }
        
        .alert-success {
            background: #166534;
            border-color: #22c55e;
            color: #dcfce7;
        }
        
        .log-display {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            color: #0f0;
            margin: 15px 0;
        }
        
        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .step-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background: #252525;
            border-radius: 8px;
        }
        
        .step-number {
            background: #ff6b00;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .step-content {
            flex: 1;
            color: #ccc;
        }
        
        .step-content h4 {
            color: #fff;
            margin: 0 0 5px 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="src/assets/images/nuts-logo.jpg" alt="$NUTS Logo" class="logo" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                <span class="brand-text">$NUTS Admin Testing</span>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="daily-contest.html" class="nav-link">Contest</a>
                <a href="admin-portal.html" class="nav-link">Admin Portal</a>
                <a href="admin-contest.html" class="nav-link">Contest Admin</a>
                <a href="admin-testing.html" class="nav-link active">Testing Portal</a>
            </div>
        </div>
    </nav>

    <div class="testing-container">
        <!-- Header -->
        <div class="testing-header">
            <h1>🧪 Admin Testing Portal</h1>
            <p>Complete end-to-end testing environment for $NUTS Sports Pick'em platform</p>
            <p><strong>Note:</strong> All wallet transactions are REAL - only game data is mocked for testing</p>
        </div>

        <!-- Testing Tabs -->
        <div class="testing-tabs">
            <div class="testing-tab active" onclick="showTestingSection('setup')">🔧 Setup & Games</div>
            <div class="testing-tab" onclick="showTestingSection('contest')">🎯 Contest Testing</div>
            <div class="testing-tab" onclick="showTestingSection('entries')">👥 User Entries</div>
            <div class="testing-tab" onclick="showTestingSection('results')">🏆 Results & Payouts</div>
            <div class="testing-tab" onclick="showTestingSection('monitoring')">📊 Monitoring</div>
        </div>

        <!-- Setup & Games Section -->
        <div id="setup" class="testing-section active">
            <h2 class="section-title">🔧 Contest Setup & Game Management</h2>
            
            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-title">📅 Contest Date Management</div>
                    <div class="input-group">
                        <label>Test Contest Date:</label>
                        <input type="date" id="contest-date" value="">
                    </div>
                    <button class="btn-testing" onclick="setContestDate()">Set Contest Date</button>
                    <button class="btn-secondary" onclick="resetToToday()">Reset to Today</button>
                    
                    <div class="status-display" id="date-status">
                        Contest Date: Loading...
                    </div>
                </div>

                <div class="control-panel">
                    <div class="control-title">🏈 Mock Game Generation</div>
                    <div class="input-group">
                        <label>Number of Games:</label>
                        <select id="game-count">
                            <option value="10" selected>10 Games (Standard)</option>
                            <option value="5">5 Games (Testing)</option>
                            <option value="15">15 Games (Extended)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Sport Type:</label>
                        <select id="sport-type">
                            <option value="MLB">Baseball (MLB)</option>
                            <option value="NFL">Football (NFL)</option>
                            <option value="NBA">Basketball (NBA)</option>
                            <option value="NHL">Hockey (NHL)</option>
                        </select>
                    </div>
                    <button class="btn-testing" onclick="generateMockGames()">Generate Mock Games</button>
                    <button class="btn-danger" onclick="clearAllGames()">Clear All Games</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">💰 Wallet Configuration</div>
                    <div class="wallet-info">
                        <h4>Contest Wallet (Receives Entry Fees)</h4>
                        <p>Address: rN2K1Tv6LEM94YN8Kxfe3QyWcGPQNgsD6d</p>
                        <p>Entry Fee: 50 NUTS per entry</p>
                    </div>
                    <div class="wallet-info">
                        <h4>NUTS Token Configuration</h4>
                        <p>Issuer: rBpdegD7kqHdczjKzTKNEUZj1Fg1eYZRbe</p>
                        <p>Currency: NUTS</p>
                    </div>
                    <button class="btn-testing" onclick="testWalletConnection()">Test Wallet Connection</button>
                </div>
            </div>

            <!-- Current Games Display -->
            <div id="current-games-display">
                <h3 style="color: #ffa500;">📋 Current Test Games</h3>
                <div id="mock-games-container" class="mock-games-grid">
                    <!-- Games will be populated here -->
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="btn-testing" onclick="quickSetupBaseball()">⚾ Quick Setup: Baseball Contest</button>
                <button class="btn-testing" onclick="quickSetupFootball()">🏈 Quick Setup: Football Contest</button>
                <button class="btn-success" onclick="publishTestContest()">🚀 Publish Test Contest</button>
            </div>
        </div>

        <!-- Contest Testing Section -->
        <div id="contest" class="testing-section">
            <h2 class="section-title">🎯 Contest Flow Testing</h2>
            
            <div class="alert alert-info">
                <strong>Testing Flow:</strong> This section allows you to test the complete contest flow from entry to completion.
                Real wallet transactions will occur when testing payments.
            </div>

            <!-- Contest Flow Steps -->
            <div class="step-indicator">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h4>Contest Entry Testing</h4>
                    <p>Test the entry process with real NUTS payments</p>
                </div>
                <button class="btn-testing" onclick="openContestPage()">Open Contest Page</button>
            </div>

            <div class="step-indicator">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h4>Payment Flow Testing</h4>
                    <p>Test Xaman wallet integration and 50 NUTS payment</p>
                </div>
                <button class="btn-testing" onclick="testPaymentFlow()">Test Payment System</button>
            </div>

            <div class="step-indicator">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h4>Picks Submission Testing</h4>
                    <p>Test the game picks submission process</p>
                </div>
                <button class="btn-testing" onclick="simulatePicksSubmission()">Simulate Picks</button>
            </div>

            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-title">⏰ Contest Timing</div>
                    <div class="input-group">
                        <label>Contest Status:</label>
                        <select id="contest-status">
                            <option value="open">Open for Entries</option>
                            <option value="locked">Locked (Games Started)</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    <button class="btn-testing" onclick="setContestStatus()">Update Status</button>
                    
                    <div class="status-display" id="contest-timing-status">
                        Status: Loading...
                    </div>
                </div>

                <div class="control-panel">
                    <div class="control-title">💳 Payment Testing</div>
                    <button class="btn-testing" onclick="generateTestQR()">Generate Test Payment QR</button>
                    <button class="btn-testing" onclick="simulateSuccessfulPayment()">Simulate Successful Payment</button>
                    <button class="btn-danger" onclick="simulateFailedPayment()">Simulate Failed Payment</button>
                    
                    <div class="status-display" id="payment-test-status">
                        Payment testing ready...
                    </div>
                </div>
            </div>
        </div>

        <!-- User Entries Section -->
        <div id="entries" class="testing-section">
            <h2 class="section-title">👥 User Entries Management</h2>
            
            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-title">🤖 Mock Entry Generation</div>
                    <div class="input-group">
                        <label>Number of Mock Entries:</label>
                        <select id="mock-entry-count">
                            <option value="3">3 Entries (Minimum Test)</option>
                            <option value="5" selected>5 Entries (Standard Test)</option>
                            <option value="10">10 Entries (Full Test)</option>
                            <option value="25">25 Entries (Stress Test)</option>
                        </select>
                    </div>
                    <button class="btn-testing" onclick="generateMockEntries()">Generate Mock Entries</button>
                    <button class="btn-danger" onclick="clearAllEntries()">Clear All Entries</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">📊 Entry Analysis</div>
                    <div class="status-display" id="entry-stats">
                        Total Entries: 0
                        Prize Pool: 0 NUTS
                        Average Score: 0
                    </div>
                    <button class="btn-testing" onclick="analyzeEntries()">Analyze Current Entries</button>
                    <button class="btn-testing" onclick="exportEntries()">Export Entry Data</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">💰 Real Entry Testing</div>
                    <div class="alert alert-warning">
                        <strong>Real Transactions:</strong> This will create actual wallet transactions
                    </div>
                    <button class="btn-success" onclick="createRealTestEntry()">Create Real Entry (50 NUTS)</button>
                    <button class="btn-testing" onclick="verifyRealEntry()">Verify Entry Transaction</button>
                </div>
            </div>

            <!-- Entries Table -->
            <div class="entries-table">
                <h3 style="padding: 20px; color: #ffa500; margin: 0;">📋 Current Contest Entries</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Entry ID</th>
                            <th>User</th>
                            <th>X Handle</th>
                            <th>Wallet</th>
                            <th>Entry Fee</th>
                            <th>Transaction ID</th>
                            <th>Picks</th>
                            <th>Score</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="entries-table-body">
                        <tr>
                            <td colspan="10" style="text-align: center; color: #888; padding: 40px;">
                                No entries found. Generate mock entries or create real entries to test.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Results & Payouts Section -->
        <div id="results" class="testing-section">
            <h2 class="section-title">🏆 Results Processing & Payouts</h2>
            
            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-title">🎲 Game Results Simulation</div>
                    <div class="input-group">
                        <label>Result Distribution:</label>
                        <select id="result-distribution">
                            <option value="random">Random Results</option>
                            <option value="home-favored">Home Team Favored (70%)</option>
                            <option value="away-favored">Away Team Favored (70%)</option>
                            <option value="balanced">Balanced (50/50)</option>
                        </select>
                    </div>
                    <button class="btn-testing" onclick="simulateGameResults()">Simulate All Game Results</button>
                    <button class="btn-testing" onclick="simulatePartialResults()">Simulate Partial Results</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">🏅 Winner Calculation</div>
                    <div class="status-display" id="winner-calculation-status">
                        Ready to calculate winners...
                    </div>
                    <button class="btn-testing" onclick="calculateTestWinners()">Calculate Winners</button>
                    <button class="btn-testing" onclick="previewPrizeDistribution()">Preview Prize Distribution</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">💸 Payout Testing</div>
                    <div class="alert alert-warning">
                        <strong>Real Payouts:</strong> These will create actual NUTS transactions to winners
                    </div>
                    <button class="btn-success" onclick="generatePayoutQRs()">Generate Payout QR Codes</button>
                    <button class="btn-danger" onclick="processTestPayouts()">Process Real Payouts</button>
                </div>
            </div>

            <!-- Winners Display -->
            <div id="winners-display">
                <h3 style="color: #ffa500;">🥇 Contest Winners</h3>
                <div id="winners-container">
                    <div style="text-align: center; color: #888; padding: 40px;">
                        No winners calculated yet. Simulate game results and calculate winners.
                    </div>
                </div>
            </div>

            <!-- Payout Queue -->
            <div id="payout-queue">
                <h3 style="color: #ffa500;">💰 Payout Queue</h3>
                <div id="payout-container">
                    <div style="text-align: center; color: #888; padding: 40px;">
                        No payouts pending. Calculate winners first.
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitoring Section -->
        <div id="monitoring" class="testing-section">
            <h2 class="section-title">📊 Real-time Monitoring</h2>
            
            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-title">📈 Live Stats</div>
                    <div class="status-display" id="live-stats">
                        Loading statistics...
                    </div>
                    <button class="btn-testing" onclick="refreshStats()">Refresh Stats</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">🔍 Transaction Monitoring</div>
                    <div class="status-display" id="transaction-monitor">
                        Monitoring wallet transactions...
                    </div>
                    <button class="btn-testing" onclick="checkTransactions()">Check Recent Transactions</button>
                </div>

                <div class="control-panel">
                    <div class="control-title">⚠️ Error Handling</div>
                    <button class="btn-danger" onclick="testErrorScenarios()">Test Error Scenarios</button>
                    <button class="btn-testing" onclick="clearErrorLogs()">Clear Error Logs</button>
                </div>
            </div>

            <!-- Activity Log -->
            <div>
                <h3 style="color: #ffa500;">📝 Activity Log</h3>
                <div class="log-display" id="activity-log">
                    [SYSTEM] Admin Testing Portal initialized
                    [INFO] Waiting for testing commands...
                </div>
            </div>

            <!-- Performance Metrics -->
            <div>
                <h3 style="color: #ffa500;">⚡ Performance Metrics</h3>
                <div class="controls-grid">
                    <div class="control-panel">
                        <div class="control-title">Response Times</div>
                        <div class="status-display" id="performance-metrics">
                            Page Load: -- ms
                            Payment Creation: -- ms
                            Database Queries: -- ms
                        </div>
                    </div>
                    <div class="control-panel">
                        <div class="control-title">System Health</div>
                        <div class="status-display" id="system-health">
                            Local Storage: OK
                            Payment System: OK
                            Contest System: OK
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Include necessary scripts -->
    <script src="src/js/contest-backend.js"></script>
    <script src="src/js/xaman-payment-nuts-correct.js"></script>
    <script src="src/js/admin-testing.js"></script>
</body>
</html>
