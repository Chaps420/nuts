<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Contest - $NUTS Sports Pick'em</title>
    <meta name="description" content="Enter the daily $NUTS sports pick'em contest. 50 $NUTS entry fee, top 3 win crypto prizes.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="src/assets/images/nuts-logo.jpg">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
      <!-- Styles -->
    <link rel="stylesheet" href="src/css/styles.css">
    <link rel="stylesheet" href="src/css/mobile-payment.css">
    
    <style>
        /* Ensure horizontal tabs override any conflicts */
        .day-tabs {
            margin-bottom: 20px !important;
            background: transparent !important;
        }
        
        .tabs-container {
            display: flex !important;
            justify-content: center !important;
            gap: 8px !important;
            flex-wrap: wrap !important;
            margin-bottom: 20px !important;
        }
        
        .day-tab {
            background: #2a2a2a !important;
            border: 2px solid #444 !important;
            border-radius: 8px !important;
            padding: 12px 16px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            text-align: center !important;
            min-width: 120px !important;
            display: flex !important;
            flex-direction: column !important;
        }
        
        .day-tab:hover {
            border-color: #4CAF50 !important;
            transform: translateY(-2px) !important;
        }
        
        .day-tab.active {
            background: #4CAF50 !important;
            color: #000 !important;
            border-color: #4CAF50 !important;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.3) !important;
        }
        
        .tab-day {
            font-weight: bold !important;
            font-size: 0.9em !important;
        }
        
        .tab-date {
            font-size: 0.75em !important;
            opacity: 0.8 !important;
            margin-top: 2px !important;
        }
        
        .tab-indicator {
            font-size: 0.7em !important;
            font-weight: bold !important;
            margin-top: 4px !important;
            padding: 2px 6px !important;
            background: rgba(255,255,255,0.1) !important;
            border-radius: 10px !important;
        }
        
        .day-tab.active .tab-indicator {
            background: rgba(0,0,0,0.2) !important;
        }
        
        /* Closed contest styling */
        .day-tab.closed {
            background: #ff4444 !important;
            border-color: #ff4444 !important;
            cursor: not-allowed !important;
            opacity: 0.9 !important;
        }
        
        .day-tab.closed:hover {
            background: #cc3333 !important;
            transform: none !important;
        }
        
        .day-tab.closed .tab-indicator {
            color: #fff !important;
            font-weight: bold !important;
            background: rgba(0,0,0,0.3) !important;
        }
        
        /* Hide any conflicting layouts */
        .contest-days-sidebar {
            display: none !important;
        }
        
        /* Ensure games section is visible */
        .games-section {
            display: block !important;
            width: 100% !important;
        }
        
        /* Games display styling */
        .games-display {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            position: relative;
        }
        
        /* Ensure games container has proper height */
        .games-grid {
            min-height: 300px;
            position: relative;
        }
        
        /* Remove ALL inner scrollbars */
        .games-display, .games-list, .games-grid, 
        .games-content-wrapper, .contest-entry,
        .entry-container, .games-section,
        #games-section, #games-grid {
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
        }
        
        /* Ensure containers don't restrict height */
        .container, .entry-container, .games-display {
            min-height: auto !important;
            max-height: none !important;
        }
        
        /* Remove scrolling from any flex containers */
        div[style*="overflow"] {
            overflow: visible !important;
        }
        
        /* Ensure only the main page scrolls */
        body {
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        main {
            overflow: visible;
        }
        
        @media (max-width: 768px) {
            .tabs-container {
                gap: 4px !important;
            }
            .day-tab {
                min-width: 100px !important;
                padding: 10px 12px !important;
            }
            
            /* Mobile-optimized game cards */
            .game-card {
                font-size: 14px !important;
            }
            
            .team-btn {
                min-height: 45px !important;
            }
            
            /* Better touch targets */
            button, .btn {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Adjust container padding */
            .container {
                padding: 10px !important;
            }
            
            /* Responsive contest rules */
            .contest-rules-horizontal > div > div {
                flex-direction: column !important;
                flex-wrap: wrap !important;
                overflow: visible !important;
            }
        }
        
        /* Authentication UI Styles */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #4CAF50;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #4CAF50;
        }
        
        .user-details {
            flex: 1;
        }
        
        .user-name {
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 4px;
        }
        
        .user-wallet {
            font-size: 0.8em;
            color: #888;
            font-family: monospace;
        }
        
        .btn-secondary {
            background: #666 !important;
            color: white !important;
        }
        
        .btn-secondary:hover {
            background: #555 !important;
        }
        
        /* Twitter handle input mobile styles */
        @media (max-width: 768px) {
            .twitter-handle-section {
                padding: 15px !important;
            }
            
            .twitter-handle-section > div {
                flex-direction: column;
                align-items: flex-start !important;
                gap: 5px !important;
            }
            
            .twitter-handle-section input {
                width: 100% !important;
                max-width: none !important;
                margin-top: 10px;
            }
            
            .twitter-handle-section span:last-child {
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="src/assets/images/nuts-logo.jpg" alt="$NUTS Logo" class="logo" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                <span class="brand-text">$NUTS</span>
            </div>
            
            <!-- Desktop Navigation -->
            <div class="nav-links desktop-nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="daily-contest.html" class="nav-link active">Daily Contest</a>
                <a href="contest-results.html" class="nav-link">Leaderboard</a>
                <a href="https://firstledger.net/token/rBpdegD7kqHdczjKzTKNEUZj1Fg1eYZRbe/4E75747300000000000000000000000000000000" target="_blank" class="nav-link">Buy $NUTS</a>
            </div>
            
            <!-- Navigation Actions -->
            <div class="nav-actions">
                <!-- Mobile menu toggle -->
                <button class="mobile-menu-toggle" id="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
        
        <!-- Mobile Navigation -->
        <div class="mobile-nav hidden" id="mobile-menu">
            <a href="index.html" class="nav-link">Home</a>
            <a href="daily-contest.html" class="nav-link">Daily Contest</a>
            <a href="contest-results.html" class="nav-link">Leaderboard</a>
            <a href="buy-nuts.html" class="nav-link">Buy $NUTS</a>
        </div>
    </nav>

    <main>
        <!-- Page Header -->
        <section class="page-header">
            <div class="container">
                <div class="header-content">
                    <h1 class="page-title">Daily Pick'em Contest</h1>
                    <p class="page-subtitle">Pick all game winners, top 3 split the $NUTS prize pool (min 4 players)</p>
                    <div class="contest-stats">
                        <div class="stat-item">
                            <span class="stat-label">Entry Fee</span>
                            <span class="stat-value accent-gold">50 $NUTS</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Today's Active Pool</span>
                            <span class="stat-value" id="prize-pool">Loading...</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Entries</span>
                            <span class="stat-value" id="entry-count">Loading...</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Time Left</span>
                            <span class="stat-value" id="time-remaining">Loading...</span>
                        </div>
                    </div>
                    <div class="contest-notice" style="background: #ff6b00; color: white; padding: 10px 20px; border-radius: 8px; margin-top: 15px; text-align: center; font-weight: bold;">
                        ⚠️ Minimum 4 players required - Contest cancelled & refunded if less than 4 entries
                    </div>
                </div>
            </div>
        </section>

        <!-- Contest Rules (Horizontal) -->
        <section class="contest-rules-horizontal" style="background: #1a1a1a; padding: 20px 0; border-bottom: 1px solid #333;">
            <div class="container">
                <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 20px;">
                    <div style="text-align: center; flex: 1; min-width: 200px;">
                        <div style="color: #4CAF50; font-size: 1.5em; margin-bottom: 5px;">💰</div>
                        <h4 style="margin: 0 0 5px 0; color: #4CAF50;">Entry Fee</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #ccc;">50 $NUTS per entry</p>
                    </div>
                    <div style="text-align: center; flex: 1; min-width: 200px;">
                        <div style="color: #4CAF50; font-size: 1.5em; margin-bottom: 5px;">🎯</div>
                        <h4 style="margin: 0 0 5px 0; color: #4CAF50;">How to Win</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #ccc;">Most correct picks wins</p>
                    </div>
                    <div style="text-align: center; flex: 1; min-width: 200px;">
                        <div style="color: #4CAF50; font-size: 1.5em; margin-bottom: 5px;">🏆</div>
                        <h4 style="margin: 0 0 5px 0; color: #4CAF50;">Prize</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #ccc;">Top 3 win (50%/30%/20%)</p>
                    </div>
                    <div style="text-align: center; flex: 1; min-width: 200px;">
                        <div style="color: #4CAF50; font-size: 1.5em; margin-bottom: 5px;">⏰</div>
                        <h4 style="margin: 0 0 5px 0; color: #4CAF50;">Deadline</h4>
                        <p style="margin: 0; font-size: 0.9em; color: #ccc;">30 min before first game</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contest Entry Section -->
        <section class="contest-entry">
            <div class="container">
                <div class="entry-container">
                    <!-- Entry Status -->
                    <div class="entry-status" id="entry-status">
                        <div class="status-card">
                            <div class="status-icon">🏆</div>
                            <h3>Make Your Picks</h3>
                            <p>Select winners for all games below, then submit your entry</p>
                        </div>
                    </div>                    <!-- Games Selection -->                    <div class="games-section" id="games-section">
                        <!-- Day Selection Tabs (Horizontal across top) -->
                        <div class="day-tabs" id="day-tabs">
                            <div class="tab-header">
                                <span>Contest Days</span>
                            </div>
                            <div class="tabs-container" id="tabs-container">
                                <!-- Tabs will be generated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Games Display -->
                        <div class="games-display" id="games-section">
                            <div class="games-grid" id="games-grid">
                                <!-- Games will be loaded here by JavaScript -->
                                <div class="loading-placeholder">
                                    <div class="spinner"></div>
                                    <p>Loading games...</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Submit Picks -->
                        <div class="submit-section hidden" id="submit-section">
                            <div class="picks-summary">
                                <h3>Your Picks</h3>
                                <div id="picks-list"></div>
                            </div>
                            
                            <!-- Tiebreaker Section -->
                            <div class="tiebreaker-section" style="background: #1a1a1a; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #333;">
                                <h4 style="color: #4CAF50; margin: 0 0 10px 0;">Tiebreaker</h4>
                                <p style="color: #ccc; font-size: 0.9em; margin-bottom: 15px;">
                                    Predict the total runs scored in the last game of the day
                                </p>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <label style="color: #888;">Total Runs:</label>
                                    <input type="number" 
                                           id="tiebreaker-runs" 
                                           min="0" 
                                           max="50" 
                                           style="background: #2a2a2a; 
                                                  border: 1px solid #444; 
                                                  color: white; 
                                                  padding: 8px 12px; 
                                                  border-radius: 4px; 
                                                  width: 100px;"
                                           placeholder="0">
                                    <span style="color: #666; font-size: 0.85em;">(Required)</span>
                                </div>
                            </div>
                            
                            <button id="submit-picks-btn" class="btn btn-success">
                                <span>Submit Your Picks</span>
                                <div class="btn-glow"></div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                
                <div class="footer-section">
                    <h4>Community</h4>
                    <ul class="footer-links">
                        <li><a href="#twitter" target="_blank">Twitter</a></li>
                        <li><a href="#discord" target="_blank">Discord</a></li>
                        <li><a href="#telegram" target="_blank">Telegram</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-legal">
                    <p>&copy; 2024 $NUTS Sports Pick'em. All rights reserved.</p>
                    <div class="legal-links">
                        <a href="#privacy">Privacy Policy</a>
                        <a href="#terms">Terms of Service</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>    <!-- Scripts -->
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-functions-compat.js"></script>
    
    <!-- App Configuration and Core Scripts -->
    <script src="config/config-browser.js"></script>
    <script src="config/environment.js"></script>
    <script src="src/js/firebase-integration.js"></script>
    <script src="src/js/xaman-payment-api.js"></script>
    <script src="src/js/payment-debug.js"></script>
    
    <!-- Global contest entry helper -->
    <script>
        window.submitContestEntry = function() {
            console.log('🚀 Direct contest entry submission');
            const manager = window.contestManager;
            if (manager && manager.handleContestEntry) {
                manager.handleContestEntry();
            } else {
                console.error('Contest manager not found');
            }
        };
        
    </script>
    
    <script src="src/js/mlb-schedule-free.js"></script>
    <script src="src/js/contests-browser.js"></script>
    <script src="src/js/contest-backend.js"></script>
    <script src="src/js/firebase-xaman-integration.js"></script>
    <script src="src/js/daily-contest-new.js"></script>
    
    <!-- Initialize Firebase when page loads -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('🔥 Initializing Firebase for contest platform...');
            
            if (window.firebaseIntegration) {
                const success = await window.firebaseIntegration.initialize();
                if (success) {
                    console.log('✅ Firebase integration ready for contest platform');
                    
                    // Set up OAuth2 event listeners
                    window.addEventListener('xamanOAuth2Success', (event) => {
                        console.log('🎉 OAuth2 authentication successful:', event.detail);
                        
                        // Update UI to show authenticated state
                        if (window.dailyContestManager) {
                            window.dailyContestManager.onWalletConnected(event.detail);
                        }
                    });
                    
                    window.addEventListener('xamanOAuth2Error', (event) => {
                        console.error('❌ OAuth2 authentication failed:', event.detail);
                        
                        // Show error to user
                        if (window.dailyContestManager) {
                            window.dailyContestManager.showError('OAuth2 authentication failed: ' + event.detail.error);
                        }
                    });
                    
                } else {
                    console.warn('⚠️ Firebase initialization failed, using local-only mode');
                }
            }
            
            // Update time remaining countdown
            function updateTimeRemaining() {
                const timeElement = document.getElementById('time-remaining');
                if (!timeElement) return;
                
                const now = new Date();
                const midnight = new Date();
                midnight.setDate(midnight.getDate() + 1);
                midnight.setHours(0, 0, 0, 0);
                
                const diff = midnight - now;
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                
                timeElement.textContent = `${hours}h ${minutes}m`;
            }
            
            // Update immediately and then every minute
            updateTimeRemaining();
            setInterval(updateTimeRemaining, 60000);
        });
    </script>
</body>
</html>
